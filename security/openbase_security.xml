<?xml version="1.0" encoding="utf-8"?>
<!--
    OpenSTC Interventions - Openerp Module to manage Cityhall technical department
    Copyright (C) 2013 Siclic www.siclic.fr

    This file is part of OpenSTC Interventions.

    OpenSTC Interventions is free software: you can redistribute it and/or modify
    it under the terms of the GNU Affero General Public License as
    published by the Free Software Foundation, either version 3 of the
    License, or (at your option) any later version.

    OpenSTC Interventions is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU Affero General Public License for more details.

    You should have received a copy of the GNU Affero General Public License
    along with OpenSTC Interventions.  If not, see <http://www.gnu.org/licenses/>.
-->
<openerp>

	<data noupdate="0">


		<!--  <delete id="res_users_rule" model="ir.rule"/> -->
		 <record model="ir.rule" id="base.res_users_rule">
	        <field name="name">Override base user rule</field>
	        <field name="model_id" ref="base.model_res_users" />
	        <field name="global" eval="True" />
	        <field name="domain_force">[(1,"=",1)]
	        </field>
		 </record>

	    <record model="ir.rule" id="service_rule">
	        <field name="name">Service Rule</field>
	        <field name="model_id" ref="model_openstc_service"/>
	        <field name="domain_force">[('id','child_of',[g.id for g in user.service_ids])]</field>
	        <field name="groups" eval="[(6,0,[ref('openbase.openstc_employee')])]" />
	        <field eval="1" name="perm_unlink"/>
	        <field eval="1" name="perm_write"/>
	        <field eval="1" name="perm_read"/>
	        <field eval="1" name="perm_create"/>
	    </record>

	    <record model="ir.rule" id="service_rule_all_access">
	        <field name="name">Service Rule All Access (DST)</field>
	        <field name="model_id" ref="model_openstc_service"/>
	        <field name="groups" eval="[(6,0,[ref('openbase.openstc_dst'),ref('hotel.group_hotel_manager')])]" />
	        <field eval="1" name="perm_unlink"/>
	        <field eval="1" name="perm_write"/>
	        <field eval="1" name="perm_read"/>
	        <field eval="1" name="perm_create"/>
	    </record>


	   	<record model="ir.rule" id="equipment_user_rule_access">
	        <field name="name">Equipment User Rule Access </field>
	        <field name="model_id" ref="model_openstc_equipment"/>
	         <field name="domain_force">[('internal_booking','=','True'),'|',('service_bookable_ids.id','child_of',[s.id for s in user.service_ids]),('service_bookable_ids','=','False')]</field>
	        <field name="groups" eval="[(6,0,[ref('hotel.group_hotel_user')])]" />
	        <field eval="1" name="perm_unlink"/>
	        <field eval="1" name="perm_write"/>
	        <field eval="1" name="perm_read"/>
	        <field eval="1" name="perm_create"/>
	    </record>


	    <record model="ir.rule" id="site_user_rule_user_access">
	        <field name="name">Site User Rule Access </field>
	        <field name="model_id" ref="model_openstc_site"/>
	         <field name="domain_force">[('internal_booking','=','True'),'|',('service_bookable_ids.id','child_of',[s.id for s in user.service_ids]),('service_bookable_ids','=','False')]</field>
	        <field name="groups" eval="[(6,0,[ref('hotel.group_hotel_user')])]" />
	        <field eval="1" name="perm_unlink"/>
	        <field eval="1" name="perm_write"/>
	        <field eval="1" name="perm_read"/>
	        <field eval="1" name="perm_create"/>
	    </record>

	   	<record model="ir.rule" id="equipment_director_rule_access">
	        <field name="name">Equipment Director Rule Access </field>
	        <field name="model_id" ref="model_openstc_equipment"/>
	         <field name="domain_force">[(1,'=',1)]</field>
	        <field name="groups" eval="[(6,0,[ref('hotel.group_hotel_manager')])]" />
	        <field eval="1" name="perm_unlink"/>
	        <field eval="1" name="perm_write"/>
	        <field eval="1" name="perm_read"/>
	        <field eval="1" name="perm_create"/>
	    </record>

	   	<record model="ir.rule" id="site_director_rule_access">
	        <field name="name">Site Director Rule Access </field>
	        <field name="model_id" ref="model_openstc_site"/>
	         <field name="domain_force">[(1,'=',1)]</field>
	        <field name="groups" eval="[(6,0,[ref('hotel.group_hotel_manager')])]" />
	        <field eval="1" name="perm_unlink"/>
	        <field eval="1" name="perm_write"/>
	        <field eval="1" name="perm_read"/>
	        <field eval="1" name="perm_create"/>
	    </record>

	</data>
</openerp>